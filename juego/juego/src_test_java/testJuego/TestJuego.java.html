<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>TestJuego.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">TestJuego (7 mar 2025 19:55:29)</a> &gt; <a href="../../index.html" class="el_group">juego</a> &gt; <a href="../index.html" class="el_bundle">src/test/java</a> &gt; <a href="index.source.html" class="el_package">testJuego</a> &gt; <span class="el_source">TestJuego.java</span></div><h1>TestJuego.java</h1><pre class="source lang-java linenums">package testJuego;

import static org.junit.Assert.assertThrows;
import static org.junit.jupiter.api.Assertions.*;

import java.time.LocalDate;
import java.util.ArrayList;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

<span class="nc" id="L12">import enums.*;</span>
import enums.WeaponType;
import enums.Department;
import excepciones.*;
import juego.*;

public class TestJuego {
	private static Juego game;
	private static Organization organization;
	private static Participantes j1, j2, j3, j4, j5, j6, j7, j8, j9, j10;
	private static Prueba p1, p2, p3;
	private static Managers m, m2;
	private static Soldiers g1, g2, g3, g4;
	private static Workers t1, t2, t3;

	@BeforeEach
	public void SetUp() {
		System.out.println(&quot;Inicializando recursos compartidos para todas las pruebas.&quot;);
<span class="nc" id="L30">		game = new Juego(&quot;Oclajoma&quot;, LocalDate.of(2025, 2, 28), 10000);</span>
		organization = new Organization();

		m = new Managers(&quot;Manager1&quot;, 102, null);
		m2 = new Managers(&quot;Manager2&quot;, 102, null);
		g1 = new Soldiers(&quot;Guardia1&quot;, WeaponType.PISTOLA_GLOCK_17, 100);
		g2 = new Soldiers(&quot;Guardia2&quot;, WeaponType.RIFLE_AUTOMATICO_HECKLER_Y_KOCH_G3, 80);
		g3 = new Soldiers(&quot;Guardia3&quot;, WeaponType.PISTOLA_GLOCK_17, 100);
		g4 = new Soldiers(&quot;Guardia4&quot;, WeaponType.RILE_DE_ASALTO_HECKLER_Y_KOCH_MP5, 80);
		t1 = new Workers(&quot;Trabajador1&quot;, Department.LIMPIEZA_DE_ELIMINADOS);
		t2 = new Workers(&quot;Trabajador2&quot;, Department.DISTRIBUCION_DE_ALIMENTOS);
		t3 = new Workers(&quot;Trabajador3&quot;, Department.PREPARACION_DE_JUEGOS);
		

		j1 = new Participantes(&quot;pollo&quot;, &quot;peel&quot;, LocalDate.of(2000, 12, 28), EnumSexo.MASCULINO, &quot;Cakahuense&quot;, 700.7);
		j2 = new Participantes(&quot;patata&quot;, &quot;peel&quot;, LocalDate.of(2000, 2, 29), EnumSexo.MASCULINO, &quot;Cakahuense&quot;, 700.7);
		j3 = new Participantes(&quot;naranja&quot;, &quot;peel&quot;, LocalDate.of(2000, 2, 29), EnumSexo.MASCULINO, &quot;Cakahuense&quot;, 700.7);
		j4 = new Participantes(&quot;paja&quot;, &quot;peel&quot;, LocalDate.of(2000, 12, 28), EnumSexo.MASCULINO, &quot;ohioyense&quot;, 700.7);
		j5 = new Participantes(&quot;caballo&quot;, &quot;peel&quot;, LocalDate.of(2000, 12, 28), EnumSexo.MASCULINO, &quot;ohioyense&quot;, 700.7);
		j6 = new Participantes(&quot;cabra&quot;, &quot;peel&quot;, LocalDate.of(2000, 12, 28), EnumSexo.MASCULINO, &quot;ohioyense&quot;, 700.7);
		j7 = new Participantes(&quot;Jugador 1&quot;, &quot;Uno&quot;, LocalDate.of(1995, 1, 1), EnumSexo.MASCULINO, &quot;España&quot;, 500);
		j8 = new Participantes(&quot;Jugador 2&quot;, &quot;Dos&quot;, LocalDate.of(1996, 2, 2), EnumSexo.FEMENINO, &quot;México&quot;, 600);
		j9 = new Participantes(&quot;Jugador 3&quot;, &quot;Tres&quot;, LocalDate.of(1997, 3, 3), EnumSexo.FEMENINO, &quot;Argentina&quot;, 700);
		j10 = new Participantes(&quot;Jugador 4&quot;, &quot;Cuatro&quot;, LocalDate.of(1998, 4, 4), EnumSexo.FEMENINO, &quot;Chile&quot;, 800);
		p1 = new Prueba(TipoPrueba.LUZ_ROJA_LUZ_VERDE);
		p2 = new Prueba(TipoPrueba.DALGONA);
		p3 = new Prueba(TipoPrueba.TIRON_DE_CUERDA);

		game.agregarParticipante(j1);
		game.agregarParticipante(j2);
		game.agregarParticipante(j3);
		game.agregarParticipante(j4);
		game.agregarParticipante(j5);
		game.agregarParticipante(j6);
		game.agregarParticipante(j7);
		game.agregarParticipante(j8);
		game.agregarParticipante(j9);
		game.agregarParticipante(j10);
		game.agregarPrueba(p1);
		game.agregarPrueba(p2);
		game.agregarPrueba(p3);
	}

	@Test
	public void testGetPruebaActual() {
<span class="nc" id="L75">		assertEquals(0, game.getPruebaActual());</span>
	}

	@Test
	public void testGetPruebaAnterior() {
<span class="nc" id="L80">		assertEquals(0, game.getPruebaAnterior());</span>
		game.setPruebaActual(1);
		assertEquals(0, game.getPruebaAnterior());
	}

	@Test
	public void testGetPruebaSiguiente() {
<span class="nc" id="L87">		assertEquals(1, game.getPruebaSiguiente());</span>
		game.setPruebaActual(3);
		assertEquals(3, game.getPruebaSiguiente());
	}

	@Test
	void testAgregarParticipante() {
<span class="nc" id="L94">		Participantes nuevo = new Participantes(&quot;Luis&quot;, &quot;perez&quot;, LocalDate.of(1998, 4, 4), EnumSexo.FEMENINO, &quot;Chile&quot;, 800);</span>
		game.agregarParticipante(nuevo);
		assertTrue(game.getParticipantes().contains(nuevo));
	}

	@Test
<span class="nc" id="L100">	void testEliminarParticipante() throws InfiltradoNoEliminableException {</span>
		
		Participantes nuevo = new Participantes(&quot;Luis&quot;, &quot;perez&quot;, LocalDate.of(1998, 4, 4), EnumSexo.FEMENINO, &quot;Chile&quot;, &quot;infiltrado1&quot;);
		InfiltradoNoEliminableException exception = assertThrows(InfiltradoNoEliminableException.class, 
			    () -&gt; nuevo.eliminar(), 
			    &quot;participante infiltrado no debe ser eliminado&quot;);
		 assertEquals(&quot;No se puede eliminar al jugador infiltrado Luis.&quot;, exception.getMessage());
		assertDoesNotThrow( 
			    () -&gt; j1.eliminar(), 
			    &quot;participante infiltrado no debe ser eliminado&quot;);
		j1.eliminar();
		assertTrue(j1.isEliminado());
		
	}

	@Test
	void testJugarRonda() {
<span class="nc" id="L117">		int participantesIniciales = game.getListaParticipantesVivos().size();</span>
		game.jugarRonda(m);
		int participantesDespues = game.getListaParticipantesVivos().size();

		assertTrue(participantesDespues &lt; participantesIniciales, &quot;Debería haber eliminados tras una ronda&quot;);
		assertEquals(1, game.getPruebaActual(), &quot;La ronda actual debería haber aumentado a 1&quot;);
	}

	@Test
<span class="nc" id="L126">	void testGetParticipantesVivos() throws InfiltradoNoEliminableException {</span>
		j1.eliminar();
		String vivos = game.getParticipantesVivos();
		assertFalse(vivos.contains(&quot;Juan&quot;), &quot;Juan debería estar eliminado&quot;);
	}

	@Test
	void testGetParticipantesMuertos()  {
		try {
<span class="nc" id="L135">			j2.eliminar();</span>
			j3.eliminar();
		} catch (InfiltradoNoEliminableException e) {
			System.err.println(e.getMessage());
		}
		String muertos = game.getParticipantesMuertos();
		assertTrue(muertos.contains(&quot;patata&quot;) &amp;&amp; muertos.contains(&quot;naranja&quot;), &quot;patata y naranja deberían estar eliminados&quot;);
	}

	@Test
	void testMostrarPruebas() {
<span class="nc" id="L146">		String pruebas = game.mostrarPruebas();</span>
		assertEquals(pruebas, &quot;LUZ_ROJA_LUZ_VERDE: Correr cuando la muñeca no mire.\nDALGONA: Cortar la galleta sin romperla.\nTIRON_DE_CUERDA: Ganar un juego de tira y afloja en equipo.\n&quot;);

	}

	@Test
	public void testSimularPrueba() {
<span class="nc" id="L153">		Prueba prueba = game.getPruebas().get(game.getPruebaActual());</span>
		game.jugarRonda(m);
		double minPorcentaje = (double) prueba.getTipo().getMinEliminados() / 100;
		double maxPorcentaje = (double) prueba.getTipo().getMaxEliminados() / 100;
		int minEliminados = (int) (prueba.getInscritos().size() * minPorcentaje);
		int maxEliminados = (int) (prueba.getInscritos().size() * maxPorcentaje);

		assertEquals(10, prueba.getInscritos().size(), &quot;Todos los participantes deben estar inscritos&quot;);
		assertTrue(prueba.getEliminados().size() &gt;= minEliminados &amp;&amp; prueba.getEliminados().size() &lt;= maxEliminados,
				&quot;Debe haber entre &quot; + minEliminados + &quot; y &quot; + maxEliminados + &quot; eliminados&quot;);
		assertEquals(10 - prueba.getEliminados().size(), prueba.getVencedores().size(),
				&quot;Los vencedores no deben ser los eliminados&quot;);

		prueba = game.getPruebas().get(game.getPruebaActual());
		ArrayList&lt;Participantes&gt; pVivos = (ArrayList&lt;Participantes&gt;) game.getListaParticipantesVivos();
		game.jugarRonda(m);
		minPorcentaje = (double) prueba.getTipo().getMinEliminados() / 100;
		maxPorcentaje = (double) prueba.getTipo().getMaxEliminados() / 100;
		minEliminados = (int) (prueba.getInscritos().size() * minPorcentaje);
		maxEliminados = (int) (prueba.getInscritos().size() * maxPorcentaje);

		assertEquals(pVivos, prueba.getInscritos(), &quot;Todos los participantes vivos deben estar inscritos&quot;);
		assertTrue(prueba.getEliminados().size() &gt;= minEliminados &amp;&amp; prueba.getEliminados().size() &lt;= maxEliminados,
				&quot;Debe haber entre &quot; + minEliminados + &quot; y &quot; + maxEliminados + &quot; eliminados&quot;);
		assertEquals(game.getListaParticipantesVivos(), prueba.getVencedores(),
				&quot;Los vencedores deben ser los participantes vivos&quot;);

		prueba = game.getPruebas().get(game.getPruebaActual());
		pVivos = (ArrayList&lt;Participantes&gt;) game.getListaParticipantesVivos();
		game.jugarRonda(m);
		minPorcentaje = (double) prueba.getTipo().getMinEliminados() / 100;
		maxPorcentaje = (double) prueba.getTipo().getMaxEliminados() / 100;
		minEliminados = (int) (prueba.getInscritos().size() * minPorcentaje);
		maxEliminados = (int) (prueba.getInscritos().size() * maxPorcentaje);

		assertEquals(pVivos, prueba.getInscritos(), &quot;Todos los participantes vivos deben estar inscritos&quot;);
		assertTrue(prueba.getEliminados().size() &gt;= minEliminados &amp;&amp; prueba.getEliminados().size() &lt;= maxEliminados,
				&quot;Debe haber entre &quot; + minEliminados + &quot; y &quot; + maxEliminados + &quot; eliminados&quot;);
		assertEquals(game.getListaParticipantesVivos(), prueba.getVencedores(),
				&quot;Los vencedores deben ser los participantes vivos&quot;);

	}

	@Test
	public void testTipoPrueba() {
<span class="nc" id="L198">		Prueba prueba = game.getPruebas().get(game.getPruebaActual());</span>
		assertEquals(&quot;Luz verde luz roja&quot;, prueba.getTipo().getNombre(), &quot;El nombre no coincide&quot;);
		assertEquals(&quot;Correr cuando la muñeca no mire.&quot;, prueba.getTipo().getDescripcion(),
				&quot;La descripción no coincide&quot;);
		assertEquals(30, prueba.getTipo().getMinEliminados(), &quot;El mínimo de eliminados no es correcto&quot;);
		assertEquals(65, prueba.getTipo().getMaxEliminados(), &quot;El máximo de eliminados no es correcto&quot;);
	}

	@Test
	void testGetParticipantes() {
<span class="nc" id="L208">		assertEquals(10, game.getParticipantes().size(), &quot;La cantidad de participantes no es correcta&quot;);</span>
		assertEquals(10000, game.getBoteTotal(), &quot;El bote total no coincide&quot;);
		assertEquals(&quot;Oclajoma&quot;, game.getUbicacion(), &quot;La ubicación no coincide&quot;);
		assertEquals(LocalDate.of(2025, 2, 28), game.getFechaEvento(), &quot;La fecha del evento no coincide&quot;);
	}
	
	 @Test
	    void testJugarRondaSinParticipantesVivos() {
<span class="nc" id="L216">	        Juego newGame =  new Juego(&quot;Oclajoma&quot;, LocalDate.of(2025, 2, 28), 10000);</span>
	        newGame.jugarRonda(m);
	        assertEquals(0, newGame.getPruebaActual());
	        
	        Prueba newPrueba = new Prueba(TipoPrueba.LUZ_ROJA_LUZ_VERDE);
	        newGame.agregarPrueba(newPrueba);
	        assertEquals(0, newGame.getPruebaActual());
	    }
	
	@Test
<span class="nc" id="L226">    void testRegisterManager() throws OrganizationException {</span>
        organization.registerManager(m);
        organization.registerManager(m2);
        assertTrue(organization.getMembers().contains(m));
        assertTrue(organization.getMembers().contains(m2));
    }
	
	@Test
<span class="nc" id="L234">    void testRegisterDuplicateManagerThrowsException() throws OrganizationException {</span>
		organization.registerManager(m);
        assertThrows(OrganizationException.class, () -&gt; {
            organization.registerManager(m);
        });
    }
	
	@Test
<span class="nc" id="L242">    void testAssignSupervisor() throws OrganizationException {</span>
        organization.registerManager(m);
        organization.addTeamMember(m, g1);
        assertEquals(m, g1.getSupervisor());
        assertTrue(m.getTeam().contains(g1));
    }
	
	@Test
<span class="nc" id="L250">    void testAddInvalidTeamMemberThrowsException() throws OrganizationException {</span>
		organization.registerManager(m);
    	organization.addTeamMember(m, m2);
    	assertFalse(m.getTeam().contains(m2));
    }
	
	@Test
<span class="nc" id="L257">    void testGetMember() throws OrganizationException {</span>
        organization.registerManager(m);
        assertEquals(m, organization.getMember(&quot;Manager1&quot;));
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span>TestJuego (7 mar 2025 19:55:29)</div></body></html>